<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Pet Health AI - –ò–ò –∞–Ω–∞–ª–∏–∑ –∑–¥–æ—Ä–æ–≤—å—è –ø–∏—Ç–æ–º—Ü–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #050816;
      --bg-elevated: #0b1020;
      --bg-elevated-soft: #11172a;
      --accent: #00e5ff;
      --accent-soft: rgba(0, 229, 255, 0.15);
      --accent-strong: #3df5ff;
      --accent-pink: #ff6fd8;
      --text: #f5f7ff;
      --text-muted: #a5afc7;
      --danger: #ff4f6b;
      --success: #00ff88;
      --border-subtle: rgba(255, 255, 255, 0.05);
      --radius-lg: 18px;
      --radius-full: 999px;
      --shadow-soft: 0 26px 60px rgba(0, 0, 0, 0.65);
      --shadow-glow: 0 0 30px rgba(0, 229, 255, 0.35);
      --transition-fast: 0.17s ease-out;
      --transition-med: 0.25s ease-out;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        Roboto, sans-serif;
      color: var(--text);
      background:
        radial-gradient(circle at 10% 0%, rgba(0, 229, 255, 0.06) 0, transparent 55%),
        radial-gradient(circle at 90% 0%, rgba(255, 111, 216, 0.07) 0, transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(0, 229, 255, 0.04) 0, transparent 50%),
        linear-gradient(145deg, #030712, #050816);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 16px;
      overflow-x: hidden;
    }

    .app-shell {
      width: 100%;
      max-width: 1400px;
      min-height: 100vh;
      border-radius: 32px;
      background: linear-gradient(145deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow-soft);
      display: grid;
      grid-template-columns: 300px 1fr;
      overflow: hidden;
      position: relative;
      backdrop-filter: blur(18px) saturate(140%);
    }

    /* HAMBURGER MENU */
    .hamburger {
      display: none;
      position: absolute;
      top: 16px;
      left: 16px;
      z-index: 1100;
      width: 40px;
      height: 40px;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      cursor: pointer;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 5px;
    }

    .hamburger span {
      display: block;
      width: 20px;
      height: 2px;
      background: var(--text);
      border-radius: 1px;
      transition: var(--transition-fast);
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translateY(10px);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translateY(-10px);
    }

    /* MODAL */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.25), transparent 60%),
                  rgba(5, 10, 30, 0.98);
      border: 1px solid rgba(0, 229, 255, 0.4);
      border-radius: 28px;
      padding: 32px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 0 60px rgba(0, 229, 255, 0.3);
      backdrop-filter: blur(18px);
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-header {
      margin-bottom: 24px;
      text-align: center;
    }

    .modal-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--text);
    }

    .modal-subtitle {
      font-size: 14px;
      color: var(--text-muted);
    }

    .modal-body {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--text);
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition-fast);
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.12);
    }

    /* SIDEBAR */
    .sidebar {
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.24), transparent 60%),
                  radial-gradient(circle at 100% 100%, rgba(255, 111, 216, 0.18), transparent 55%),
                  #050817;
      border-right: 1px solid rgba(255, 255, 255, 0.06);
      padding: 24px 20px 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      overflow-y: auto;
      transition: transform var(--transition-med);
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-circle {
      width: 42px;
      height: 42px;
      border-radius: 14px;
      background: radial-gradient(circle at 30% 0, #fff, #c9f7ff 35%, #00e5ff 80%);
      box-shadow:
        0 0 20px rgba(0, 229, 255, 0.65),
        0 12px 30px rgba(1, 15, 35, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .logo-title {
      font-weight: 700;
      font-size: 15px;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo-pill {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(0, 229, 255, 0.15);
      border: 1px solid rgba(0, 229, 255, 0.5);
      font-size: 10px;
      text-transform: uppercase;
      color: var(--accent-strong);
      font-weight: 600;
    }

    .logo-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .pet-card {
      padding: 14px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(5, 13, 35, 0.85), rgba(9, 18, 48, 0.95));
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 18px 35px rgba(0,0,0,0.6);
      display: flex;
      gap: 12px;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    .pet-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.18), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(255, 111, 216, 0.15), transparent 55%);
      pointer-events: none;
    }

    .pet-avatar {
      position: relative;
      z-index: 1;
      flex-shrink: 0;
      width: 44px;
      height: 44px;
      border-radius: 16px;
      background: rgba(2, 10, 30, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.14);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .pet-info {
      position: relative;
      z-index: 1;
      flex: 1;
    }

    .pet-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--text);
    }

    .pet-meta {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .pets-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .pet-item {
      padding: 10px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      cursor: pointer;
      transition: var(--transition-fast);
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .pet-item:hover {
      background: rgba(0, 229, 255, 0.12);
      border-color: rgba(0, 229, 255, 0.3);
    }

    .pet-item.active {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.12), rgba(255, 111, 216, 0.12));
      border-color: rgba(0, 229, 255, 0.6);
    }

    .sidebar-nav {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-section-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-muted);
      margin-bottom: 6px;
      padding: 0 4px;
    }

    .nav-btn {
      width: 100%;
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-size: 13px;
      transition: var(--transition-fast);
      font-weight: 500;
    }

    .nav-btn span.icon {
      font-size: 18px;
      width: 20px;
      text-align: center;
    }

    .nav-btn.active {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.12), rgba(255, 111, 216, 0.12));
      border-color: rgba(0, 229, 255, 0.6);
      color: var(--text);
      box-shadow: var(--shadow-glow);
    }

    .nav-btn:hover:not(.active) {
      background: rgba(255, 255, 255, 0.03);
      color: var(--text);
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 11px;
      color: var(--text-muted);
      line-height: 1.4;
      padding-top: 12px;
      border-top: 1px solid rgba(255, 255, 255, 0.04);
    }

    .sidebar-footer strong {
      color: var(--danger);
    }

    /* CONTENT */
    .content {
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      overflow-y: auto;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
    }

    .header-title h1 {
      margin: 0 0 4px 0;
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .header-title p {
      margin: 0;
      font-size: 14px;
      color: var(--text-muted);
    }

    .header-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
    }

    .badge {
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(6, 16, 40, 0.9);
    }

    .badge.ai {
      border-color: rgba(0, 229, 255, 0.8);
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.35), transparent 65%);
      color: var(--accent-strong);
    }

    .badge span.dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(0, 229, 255, 0.8);
    }

    /* TABS */
    .tabs {
      display: flex;
      gap: 8px;
      padding: 3px;
      border-radius: var(--radius-full);
      background: rgba(3, 12, 34, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.08);
      width: fit-content;
      overflow-x: auto;
    }

    .tab-btn {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: var(--transition-fast);
      white-space: nowrap;
    }

    .tab-btn.active {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.18), rgba(255, 111, 216, 0.16));
      color: var(--text);
      box-shadow: var(--shadow-glow);
    }

    .tab-btn span.emoji {
      font-size: 16px;
    }

    .content-main {
      display: grid;
      grid-template-columns: 1.8fr 1.2fr;
      gap: 20px;
      flex: 1;
    }

    /* CARDS */
    .card {
      border-radius: var(--radius-lg);
      background: rgba(5, 10, 30, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.6);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-subtitle {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 3px;
    }

    .chip {
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 11px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.03);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .chip.ai {
      border-color: rgba(0, 229, 255, 0.7);
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.32), transparent 70%);
      color: var(--accent-strong);
    }

    /* FORM FIELDS */
    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .field-label {
      font-size: 12px;
      color: var(--text);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
    }

    .field-label span.required {
      color: var(--accent-strong);
      font-weight: 600;
    }

    .input-wrapper {
      position: relative;
      border-radius: 14px;
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.14), transparent 60%),
                  rgba(6, 14, 40, 0.98);
      border: 1px solid var(--border-subtle);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: flex-start;
      padding: 11px 13px;
      transition: var(--transition-med);
    }

    .input-wrapper::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      border: 1px solid transparent;
      background:
        linear-gradient(120deg, rgba(0, 229, 255, 0.6), rgba(255, 111, 216, 0.5), transparent) border-box;
      opacity: 0;
      transition: var(--transition-med);
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .input-wrapper input,
    .input-wrapper textarea,
    .input-wrapper select {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      color: var(--text);
      font-size: 13px;
      font-family: inherit;
      width: 100%;
    }

    .input-wrapper input::placeholder,
    .input-wrapper textarea::placeholder {
      color: rgba(255, 255, 255, 0.25);
    }

    .input-wrapper textarea {
      resize: vertical;
      min-height: 80px;
      max-height: 160px;
      padding: 0;
    }

    .input-wrapper select {
      appearance: none;
      padding: 0;
      padding-right: 6px;
      color: var(--text);
    }

    .input-wrapper select option {
      background: #050816;
      color: var(--text);
    }

    .input-wrapper span.leading-icon {
      margin-right: 10px;
      font-size: 16px;
      opacity: 0.85;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .input-wrapper:focus-within {
      border-color: rgba(0, 229, 255, 0.8);
      box-shadow: var(--shadow-glow);
      transform: translateY(-1px);
    }

    .input-wrapper:focus-within::before {
      opacity: 0.8;
    }

    .input-hint {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    /* BUTTONS */
    .btn-row {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 10px;
      margin-top: 4px;
    }

    .btn {
      border-radius: var(--radius-full);
      border: none;
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: var(--transition-med);
      white-space: nowrap;
      min-height: 44px;
    }

    .btn-primary {
      background: linear-gradient(90deg, #00e5ff, #3df5ff, #00b3ff);
      background-size: 200% 100%;
      color: #021018;
      box-shadow:
        0 0 22px rgba(0, 229, 255, 0.75),
        0 16px 26px rgba(1, 11, 30, 0.9);
    }

    .btn-primary:hover:not([disabled]) {
      transform: translateY(-2px) scale(1.02);
      background-position: 100% 50%;
      box-shadow:
        0 0 28px rgba(0, 229, 255, 0.9),
        0 20px 32px rgba(1, 11, 30, 0.95);
    }

    .btn-ghost {
      background: rgba(255, 255, 255, 0.04);
      color: var(--text-muted);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .btn-ghost:hover:not([disabled]) {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
    }

    .btn-support {
      background: linear-gradient(90deg, #ff6fd8, #ff1493, #ff6fd8);
      background-size: 200% 100%;
      color: white;
      box-shadow:
        0 0 22px rgba(255, 111, 216, 0.75),
        0 16px 26px rgba(1, 11, 30, 0.9);
      width: 100%;
    }

    .btn-support:hover:not([disabled]) {
      transform: translateY(-2px) scale(1.02);
      background-position: 100% 50%;
      box-shadow:
        0 0 28px rgba(255, 111, 216, 0.9),
        0 20px 32px rgba(1, 11, 30, 0.95);
    }

    .btn[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* PROGRESS BAR */
    .progress-bar {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      overflow: hidden;
      background: rgba(6, 18, 45, 0.96);
      border: 1px solid rgba(0, 229, 255, 0.25);
      box-shadow: 0 0 18px rgba(0, 229, 255, 0.35);
      opacity: 0;
      transform: translateY(6px) scaleX(0.95);
      pointer-events: none;
      transition: var(--transition-med);
      margin-bottom: -8px;
    }

    .progress-bar.active {
      opacity: 1;
      transform: translateY(0) scaleX(1);
      margin-bottom: 8px;
    }

    .progress-bar-inner {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-pink), var(--accent));
      background-size: 200% 100%;
      width: 0%;
      animation: progressGradient 1.4s linear infinite;
    }

    .progress-bar-inner.indeterminate {
      width: 55%;
      animation: progressIndeterminate 1.2s infinite linear, progressGradient 1.4s linear infinite;
    }

    @keyframes progressGradient {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    @keyframes progressIndeterminate {
      0% { transform: translateX(-60%); }
      100% { transform: translateX(145%); }
    }

    /* AI RESULT */
    .ai-result {
      border-radius: 16px;
      background: radial-gradient(circle at 0 0, rgba(0, 229, 255, 0.25), transparent 60%),
                  rgba(4, 10, 30, 0.98);
      border: 1px solid rgba(0, 229, 255, 0.4);
      padding: 13px;
      margin-top: 8px;
      font-size: 13px;
      color: var(--text);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.75);
      display: none;
      animation: slideIn 0.3s ease-out;
      max-height: 400px;
      overflow-y: auto;
    }

    .ai-result.visible {
      display: block;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .ai-result-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      position: sticky;
      top: 0;
      background: rgba(4, 10, 30, 0.98);
      padding-bottom: 8px;
    }

    .ai-result-header span.dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 12px rgba(0, 229, 255, 0.9);
    }

    .ai-result-title {
      font-size: 13px;
      font-weight: 700;
    }

    .ai-result-body {
      line-height: 1.6;
      color: var(--text-muted);
      font-size: 12px;
    }

    /* CHAT MODE */
    .chat-container {
      display: none;
      flex-direction: column;
      gap: 12px;
      flex: 1;
      min-height: 0;
    }

    .chat-container.active {
      display: flex;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 12px 0;
      border-radius: 14px;
    }

    .chat-message {
      padding: 12px 14px;
      border-radius: 12px;
      font-size: 12px;
      line-height: 1.6;
      animation: slideIn 0.3s ease-out;
    }

    .chat-message.user {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.15), rgba(255, 111, 216, 0.15));
      border: 1px solid rgba(0, 229, 255, 0.3);
      color: var(--text);
      align-self: flex-end;
      max-width: 85%;
    }

    .chat-message.ai {
      background: rgba(4, 10, 30, 0.8);
      border: 1px solid rgba(0, 229, 255, 0.4);
      color: var(--text-muted);
      align-self: flex-start;
      max-width: 95%;
    }

    .chat-message.ai h4 {
      margin: 12px 0 6px 0;
      color: var(--accent-strong);
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .chat-message.ai h4:first-child {
      margin-top: 0;
    }

    .chat-message.ai ul {
      margin: 6px 0;
      padding-left: 18px;
    }

    .chat-message.ai li {
      margin-bottom: 4px;
      color: var(--text-muted);
    }

    .chat-message.ai strong {
      color: var(--text);
    }

    .chat-message.ai p {
      margin: 4px 0;
    }

    .chat-message.loading {
      background: rgba(4, 10, 30, 0.8);
      border: 1px solid rgba(0, 229, 255, 0.4);
      color: var(--text-muted);
      align-self: flex-start;
      max-width: 95%;
    }

    .chat-message.loading::after {
      content: '';
      display: inline-block;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--accent);
      margin-left: 4px;
      animation: dot-pulse 1.4s infinite;
    }

    @keyframes dot-pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }

    .chat-input-row {
      display: flex;
      gap: 8px;
      align-items: flex-end;
    }

    .chat-input-row .input-wrapper {
      flex: 1;
      margin: 0;
      min-height: auto;
    }

    .chat-input-row textarea {
      min-height: 40px;
      max-height: 100px;
      padding: 8px 0 !important;
    }

    /* QUICK SYMPTOMS */
    .quick-symptoms {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .quick-symptoms label {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border-radius: 10px;
      background: transparent;
      cursor: pointer;
      transition: var(--transition-fast);
      font-size: 13px;
      min-height: 44px;
    }

    .quick-symptoms label:hover {
      background: rgba(255, 255, 255, 0.04);
    }

    .quick-symptoms input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--accent);
      flex-shrink: 0;
    }

    /* FILE UPLOAD */
    .file-upload-zone {
      position: relative;
      border-radius: 14px;
      border: 2px dashed rgba(0, 229, 255, 0.3);
      padding: 24px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition-med);
      background: rgba(0, 229, 255, 0.04);
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .file-upload-zone:hover {
      border-color: rgba(0, 229, 255, 0.6);
      background: rgba(0, 229, 255, 0.08);
    }

    .file-upload-zone input[type="file"] {
      display: none;
    }

    .file-upload-text {
      font-size: 14px;
      color: var(--text);
      font-weight: 500;
    }

    .file-upload-hint {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .about-content {
      line-height: 1.8;
      color: var(--text-muted);
    }

    .about-content h3 {
      color: var(--accent-strong);
      margin-top: 16px;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .about-content ul {
      margin: 8px 0;
      padding-left: 20px;
    }

    .about-content li {
      margin-bottom: 6px;
      font-size: 12px;
    }

    .modal-footer {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      gap: 10px;
      flex-direction: column;
    }

    /* ===== RESPONSIVE DESIGN ===== */

    /* Tablet: 768px - 1200px */
    @media (max-width: 1200px) {
      .app-shell {
        grid-template-columns: 260px 1fr;
        max-width: 100%;
        border-radius: 20px;
      }

      .content-main {
        grid-template-columns: 1.5fr 1fr;
        gap: 16px;
      }

      .content {
        padding: 20px;
        gap: 16px;
      }

      .card {
        padding: 16px;
      }

      .header-title h1 {
        font-size: 24px;
      }
    }

    /* Tablet: 768px - 1000px */
    @media (max-width: 1000px) {
      .app-shell {
        grid-template-columns: 1fr;
        min-height: 100vh;
        border-radius: 16px;
      }

      .sidebar {
        position: fixed;
        left: -100%;
        top: 0;
        width: 280px;
        height: 100vh;
        z-index: 999;
        border-right: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 0;
        box-shadow: var(--shadow-soft);
      }

      .sidebar.active {
        left: 0;
      }

      .hamburger {
        display: flex;
      }

      .content {
        padding: 16px;
        gap: 14px;
        padding-top: 70px;
      }

      .content-main {
        grid-template-columns: 1fr;
        gap: 14px;
      }

      .header-title h1 {
        font-size: 22px;
      }

      .header-badges {
        justify-content: flex-start;
        width: 100%;
      }

      .card {
        padding: 14px;
      }

      .tabs {
        width: 100%;
      }

      .tab-btn {
        padding: 7px 12px;
        font-size: 12px;
      }
    }

    /* Mobile: < 768px */
    @media (max-width: 768px) {
      body {
        padding: 8px;
      }

      .app-shell {
        min-height: auto;
        border-radius: 12px;
      }

      .sidebar {
        width: 100%;
        padding: 16px;
      }

      .content {
        padding: 12px;
        gap: 12px;
        padding-top: 60px;
      }

      .content-header {
        flex-direction: column;
        gap: 12px;
      }

      .header-title h1 {
        font-size: 20px;
      }

      .header-title p {
        font-size: 12px;
      }

      .header-badges {
        justify-content: flex-start;
        gap: 6px;
      }

      .badge {
        padding: 5px 10px;
        font-size: 11px;
      }

      .card {
        padding: 12px;
      }

      .card-title {
        font-size: 14px;
      }

      .card-subtitle {
        font-size: 11px;
      }

      .field-label {
        font-size: 11px;
      }

      .input-wrapper {
        padding: 10px 11px;
      }

      .btn {
        padding: 10px 14px;
        font-size: 12px;
        min-height: 40px;
      }

      .btn-row {
        flex-wrap: wrap;
      }

      .tabs {
        width: 100%;
        overflow-x: auto;
        gap: 4px;
      }

      .tab-btn {
        padding: 6px 10px;
        font-size: 11px;
        gap: 4px;
      }

      .tab-btn span.emoji {
        font-size: 14px;
      }

      .chat-message.user {
        max-width: 90%;
      }

      .chat-message.ai {
        max-width: 100%;
      }

      .quick-symptoms label {
        padding: 8px;
        min-height: 40px;
      }

      .quick-symptoms input[type="checkbox"] {
        width: 16px;
        height: 16px;
      }

      .modal-content {
        padding: 20px;
        border-radius: 16px;
        max-width: 90vw;
      }

      .modal-title {
        font-size: 24px;
      }

      .modal-close {
        width: 36px;
        height: 36px;
        font-size: 20px;
      }

      .ai-result {
        font-size: 12px;
        padding: 11px;
        max-height: 300px;
      }

      .ai-result-body {
        font-size: 11px;
      }

      .logo-title {
        font-size: 13px;
      }

      .logo-subtitle {
        font-size: 11px;
      }

      .pet-name {
        font-size: 13px;
      }

      .pet-meta {
        font-size: 10px;
      }
    }

    /* Mobile: < 480px */
    @media (max-width: 480px) {
      body {
        padding: 4px;
      }

      .app-shell {
        border-radius: 8px;
      }

      .content {
        padding: 8px;
        gap: 8px;
        padding-top: 50px;
      }

      .header-title h1 {
        font-size: 18px;
        margin-bottom: 2px;
      }

      .header-title p {
        font-size: 11px;
      }

      .card {
        padding: 10px;
      }

      .card-title {
        font-size: 13px;
      }

      .btn {
        padding: 8px 12px;
        font-size: 11px;
        min-height: 36px;
      }

      .field-label {
        font-size: 10px;
      }

      .input-wrapper {
        padding: 8px 10px;
      }

      .input-wrapper input,
      .input-wrapper textarea,
      .input-wrapper select {
        font-size: 12px;
      }

      .tabs {
        gap: 2px;
      }

      .tab-btn {
        padding: 5px 8px;
        font-size: 10px;
      }

      .modal-content {
        padding: 16px;
        max-width: 95vw;
      }

      .modal-title {
        font-size: 20px;
      }

      .hamburger {
        width: 36px;
        height: 36px;
      }

      .hamburger span {
        width: 16px;
      }
    }

    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(0, 229, 255, 0.3);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 229, 255, 0.5);
    }
  </style>
</head>
<body>

<button class="hamburger" id="hamburger">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ü–ò–¢–û–ú–¶–ê -->
<div class="modal" id="registerPetModal">
  <div class="modal-content">
    <button class="modal-close" onclick="document.getElementById('registerPetModal').classList.remove('active')">√ó</button>
    <div class="modal-header">
      <div class="modal-title">üêæ –í–∞—à –ø–∏—Ç–æ–º–µ—Ü</div>
      <div class="modal-subtitle">–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–º –ø–∏—Ç–æ–º—Ü–µ</div>
    </div>
    <div class="modal-body">
      <div class="field">
        <div class="field-label">–ò–º—è –ø–∏—Ç–æ–º—Ü–∞ <span class="required">*</span></div>
        <div class="input-wrapper">
          <span class="leading-icon">üè∑Ô∏è</span>
          <input id="petNameInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë–∞—Ä—Å–∏–∫, –®–∞—Ä–∏–∫..." />
        </div>
      </div>

      <div class="field">
        <div class="field-label">–í–∏–¥ –ø–∏—Ç–æ–º—Ü–∞ <span class="required">*</span></div>
        <div class="input-wrapper">
          <span class="leading-icon">üêæ</span>
          <select id="petTypeSelect">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥</option>
            <option value="üê± –ö–æ—à–∫–∞">üê± –ö–æ—à–∫–∞</option>
            <option value="üêï –°–æ–±–∞–∫–∞">üêï –°–æ–±–∞–∫–∞</option>
            <option value="üêπ –•–æ–º—è–∫">üêπ –•–æ–º—è–∫</option>
            <option value="üê¶ –ü–æ–ø—É–≥–∞–π">üê¶ –ü–æ–ø—É–≥–∞–π</option>
            <option value="üê¢ –ß–µ—Ä–µ–ø–∞—Ö–∞">üê¢ –ß–µ—Ä–µ–ø–∞—Ö–∞</option>
            <option value="üê† –†—ã–±–∫–∞">üê† –†—ã–±–∫–∞</option>
            <option value="üê∞ –ö—Ä–æ–ª–∏–∫">üê∞ –ö—Ä–æ–ª–∏–∫</option>
            <option value="ü¶é –î—Ä—É–≥–æ–µ">ü¶é –î—Ä—É–≥–æ–µ</option>
          </select>
        </div>
      </div>

      <div class="field">
        <div class="field-label">–ü–æ–ª <span class="required">*</span></div>
        <div class="input-wrapper">
          <span class="leading-icon">‚öß</span>
          <select id="petGenderSelect">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
            <option value="‚ôÇÔ∏è –°–∞–º–µ—Ü">‚ôÇÔ∏è –°–∞–º–µ—Ü</option>
            <option value="‚ôÄÔ∏è –°–∞–º–∫–∞">‚ôÄÔ∏è –°–∞–º–∫–∞</option>
          </select>
        </div>
      </div>

      <div class="field">
        <div class="field-label">–ü–æ—Ä–æ–¥–∞</div>
        <div class="input-wrapper">
          <span class="leading-icon">üìã</span>
          <input id="petBreedInput" placeholder="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ" />
        </div>
      </div>

      <div class="field">
        <div class="field-label">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç)</div>
        <div class="input-wrapper">
          <span class="leading-icon">üìÖ</span>
          <input id="petAgeInput" type="number" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 3" />
        </div>
      </div>

      <div class="field">
        <div class="field-label">–í–µ—Å (–∫–≥)</div>
        <div class="input-wrapper">
          <span class="leading-icon">‚öñÔ∏è</span>
          <input id="petWeightInput" type="number" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5.5" />
        </div>
      </div>

      <div class="btn-row" style="margin-top: 16px;">
        <button class="btn btn-primary" onclick="savePet()" style="width: 100%;">
          <span>‚ú® –î–æ–±–∞–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- –û –°–ï–†–í–ò–°–ï -->
<div class="modal" id="aboutModal">
  <div class="modal-content">
    <button class="modal-close" onclick="document.getElementById('aboutModal').classList.remove('active')">√ó</button>
    <div class="modal-header">
      <div class="modal-title">‚ÑπÔ∏è –û —Å–µ—Ä–≤–∏—Å–µ</div>
      <div class="modal-subtitle">Pet Health AI</div>
    </div>
    <div class="modal-body">
      <div class="about-content">
        <p><strong>Pet Health AI</strong> ‚Äî —ç—Ç–æ –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤–∞—à–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞. –°–µ—Ä–≤–∏—Å –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Å–∏–º–ø—Ç–æ–º—ã –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ.</p>

        <h3>üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</h3>
        <ul>
          <li>üìù –ê–Ω–∞–ª–∏–∑ —Å–∏–º–ø—Ç–æ–º–æ–≤ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é</li>
          <li>‚ö° –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–∑ —Ç–∏–ø–∏—á–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤</li>
          <li>üì∏ –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –ø–∏—Ç–æ–º—Ü–∞</li>
          <li>üêæ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∏—Ç–æ–º—Ü–µ–≤</li>
          <li>üí¨ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</li>
          <li>ü§ñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ò–ò DeepSeek</li>
        </ul>

        <h3>‚ö†Ô∏è –í–∞–∂–Ω–æ:</h3>
        <ul>
          <li>–≠—Ç–æ <strong>–ù–ï</strong> –∑–∞–º–µ–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É</li>
          <li>–ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä—å—ë–∑–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤—Ä–∞—á—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ</li>
          <li>–ò–ò –∞–Ω–∞–ª–∏–∑ ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</li>
          <li>–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –¥–∏–∞–≥–Ω–æ–∑–∞ –Ω—É–∂–µ–Ω –æ—Å–º–æ—Ç—Ä —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞</li>
        </ul>

        <h3>üîí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å:</h3>
        <ul>
          <li>–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (localStorage)</li>
          <li>–ú—ã –Ω–µ —Å–æ–±–∏—Ä–∞–µ–º –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë–º –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</li>
          <li>–ü–æ–ª–Ω–∞—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
        </ul>

        <h3>‚ùì –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
        <ul>
          <li>1. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</li>
          <li>2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –∞–Ω–∞–ª–∏–∑–∞ (—Å–∏–º–ø—Ç–æ–º—ã, –±—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–ª–∏ —Ñ–æ—Ç–æ)</li>
          <li>3. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ</li>
          <li>4. –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç –ò–ò</li>
          <li>5. –ó–∞–¥–∞–≤–∞–π—Ç–µ –¥–æ–ø. –≤–æ–ø—Ä–æ—Å—ã –ø—Ä—è–º–æ –≤ —á–∞—Ç–µ</li>
          <li>6. –ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–æ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
        </ul>

        <h3>üöÄ –í–µ—Ä—Å–∏—è:</h3>
        <p>Pet Health AI v4.0 Responsive ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å</p>
      </div>

      <div class="modal-footer">
        <a href="https://t.me/l_Roman8" target="_blank" class="btn btn-support">
          <span>üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ @l_Roman8</span>
        </a>
      </div>
    </div>
  </div>
</div>

<div class="app-shell">
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo-circle">üêæ</div>
      <div class="logo-text">
        <div class="logo-title">
          <span>Pet Health AI</span>
          <span class="logo-pill">AI</span>
        </div>
        <div class="logo-subtitle">–ò–ò‚Äë–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –ø–∏—Ç–æ–º—Ü–∞</div>
      </div>
    </div>

    <div class="pet-card">
      <div class="pet-avatar" id="sidebarAvatar">üêï</div>
      <div class="pet-info">
        <div class="pet-name" id="sidebarPetName">–î–æ–±–∞–≤—å—Ç–µ –ø–∏—Ç–æ–º—Ü–∞</div>
        <div class="pet-meta" id="sidebarPetMeta">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ</div>
      </div>
    </div>

    <div style="display: flex; gap: 8px;">
      <button class="btn btn-primary" onclick="openPetModal()" style="flex: 1; padding: 8px 14px; font-size: 12px;">
        ‚ûï –î–æ–±–∞–≤–∏—Ç—å
      </button>
      <button class="btn btn-ghost" onclick="togglePetsList()" style="flex: 1; padding: 8px 14px; font-size: 12px;">
        üìã –ú–æ–∏
      </button>
    </div>

    <div id="petsList" style="display: none;">
      <div class="nav-section-label">–ü–∏—Ç–æ–º—Ü—ã</div>
      <div class="pets-list" id="petsListContainer"></div>
    </div>

    <div class="sidebar-nav">
      <div class="nav-section-label">–û—Å–Ω–æ–≤–Ω—ã–µ</div>

      <button class="nav-btn active" data-section="analysis">
        <span class="icon">üìã</span>
        <span>–ê–Ω–∞–ª–∏–∑</span>
      </button>

      <button class="nav-btn" onclick="closeSidebar(); document.getElementById('aboutModal').classList.add('active')">
        <span class="icon">‚ÑπÔ∏è</span>
        <span>–û —Å–µ—Ä–≤–∏—Å–µ</span>
      </button>
    </div>

    <div class="sidebar-footer">
      ‚ö†Ô∏è –≠—Ç–æ <strong>–Ω–µ</strong> –∑–∞–º–µ–Ω–∞ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É. –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É!
    </div>
  </aside>

  <main class="content">
    <div class="content-header">
      <div>
        <h1>–ê–Ω–∞–ª–∏–∑ –∑–¥–æ—Ä–æ–≤—å—è –ø–∏—Ç–æ–º—Ü–∞</h1>
        <p>–û–ø–∏—à–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ ‚Äî –ò–ò –ø–æ–¥—Å–∫–∞–∂–µ—Ç, –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ</p>
      </div>
      <div class="header-badges">
        <div class="badge ai">
          <span class="dot"></span>
          <span>DeepSeek –ò–ò</span>
        </div>
        <div class="badge">
          <span>üí¨</span>
          <span>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç</span>
        </div>
      </div>
    </div>

    <div class="tabs" id="modeTabs">
      <button class="tab-btn active" data-tab="symptoms">
        <span class="emoji">üìù</span>
        <span>–ü–æ —Å–∏–º–ø—Ç–æ–º–∞–º</span>
      </button>
      <button class="tab-btn" data-tab="fast">
        <span class="emoji">‚ö°</span>
        <span>–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</span>
      </button>
      <button class="tab-btn" data-tab="photo">
        <span class="emoji">üì∏</span>
        <span>–ü–æ —Ñ–æ—Ç–æ</span>
      </button>
    </div>

    <div class="progress-bar" id="requestProgress">
      <div class="progress-bar-inner indeterminate"></div>
    </div>

    <div class="content-main">
      <!-- –ê–ù–ê–õ–ò–ó –ü–û –°–ò–ú–ü–¢–û–ú–ê–ú -->
      <section class="card" id="tab-symptoms">
        <div class="card-header">
          <div>
            <div class="card-title">üìù –ü–æ —Å–∏–º–ø—Ç–æ–º–∞–º</div>
            <div class="card-subtitle">
              –û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –±–µ—Å–ø–æ–∫–æ–∏—Ç –ø–∏—Ç–æ–º—Ü–∞. –ò–ò –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –¥–∞—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            </div>
          </div>
          <div class="chip ai">
            <span>ü§ñ</span>
            <span>DeepSeek –ò–ò</span>
          </div>
        </div>

        <div id="symptomsFormMode">
          <div class="field">
            <div class="field-label">
              <span>–°–∏–º–ø—Ç–æ–º—ã</span>
              <span class="required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>
            </div>
            <div class="input-wrapper">
              <span class="leading-icon">‚úèÔ∏è</span>
              <textarea id="symptomsInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –Ω–µ –µ—Å—Ç –≤—Ç–æ—Ä–æ–π –¥–µ–Ω—å, –≤—è–ª—ã–π, —Ä–≤–æ—Ç–∞ –ø–æ —É—Ç—Ä–∞–º, –ø–æ–Ω–æ—Å..."></textarea>
            </div>
            <div class="input-hint">–û–ø–∏—à–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞</div>
          </div>

          <div class="field">
            <div class="field-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</div>
            <div class="input-wrapper">
              <span class="leading-icon">‚ÑπÔ∏è</span>
              <input id="extraInfoInput" placeholder="–í–µ—Å, –≤–æ–∑—Ä–∞—Å—Ç, –ø—Ä–∏—ë–º –ª–µ–∫–∞—Ä—Å—Ç–≤..." />
            </div>
          </div>

          <div class="btn-row">
            <button class="btn btn-ghost" type="button" id="clearSymptoms">–û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn btn-primary" type="button" id="analyzeSymptomsBtn">
              <span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span>
              <span>‚Üí</span>
            </button>
          </div>
        </div>

        <div class="ai-result" id="symptomsResult">
          <div class="ai-result-header">
            <span class="dot"></span>
            <span class="ai-result-title">–ò–ò‚Äë—Ä–∞–∑–±–æ—Ä —Å–∏–º–ø—Ç–æ–º–æ–≤</span>
          </div>
          <div class="ai-result-body" id="symptomsResultBody"></div>
        </div>

        <div class="chat-container" id="symptomsChatMode">
          <div class="chat-messages" id="symptomsChatMessages"></div>
          <div class="chat-input-row">
            <div class="input-wrapper" style="margin: 0;">
              <span class="leading-icon">üí¨</span>
              <textarea id="symptomsChatInput" placeholder="–ó–∞–¥–∞–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å..." style="min-height: 40px; max-height: 100px;"></textarea>
            </div>
            <button class="btn btn-primary" onclick="sendFollowUpQuestion('symptoms')" style="padding: 10px 14px; margin: 0;">
              ‚Üë
            </button>
          </div>
        </div>

        <div class="btn-row" id="symptomsChatControls" style="display: none; margin-top: 12px;">
          <button class="btn btn-ghost" onclick="resetAnalysis('symptoms')">
            <span>üîÑ –ù–æ–≤—ã–π —á–∞—Ç</span>
          </button>
        </div>
      </section>

      <!-- –ë–´–°–¢–†–´–ô –í–´–ë–û–† -->
      <section class="card" id="tab-fast" style="display:none;">
        <div class="card-header">
          <div>
            <div class="card-title">‚ö° –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</div>
            <div class="card-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ —Å–ø–∏—Å–∫–∞</div>
          </div>
          <div class="chip">
            <span>üéØ</span>
            <span>–¢–∏–ø–∏—á–Ω—ã–µ</span>
          </div>
        </div>

        <div id="fastFormMode">
          <div class="field">
            <div class="field-label">–°–∏–º–ø—Ç–æ–º—ã –ø–∏—Ç–æ–º—Ü–∞</div>
            <div class="input-hint">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—É–Ω–∫—Ç–æ–≤</div>
          </div>

          <div class="quick-symptoms">
            <label><input type="checkbox" class="fast-symptom" value="–ù–µ –µ—Å—Ç" /> –ù–µ –µ—Å—Ç</label>
            <label><input type="checkbox" class="fast-symptom" value="–†–≤–æ—Ç–∞" /> –†–≤–æ—Ç–∞</label>
            <label><input type="checkbox" class="fast-symptom" value="–í—è–ª–æ—Å—Ç—å" /> –í—è–ª–æ—Å—Ç—å</label>
            <label><input type="checkbox" class="fast-symptom" value="–ü–æ–Ω–æ—Å" /> –ü–æ–Ω–æ—Å</label>
            <label><input type="checkbox" class="fast-symptom" value="–ó–∞–ø–æ—Ä" /> –ó–∞–ø–æ—Ä</label>
            <label><input type="checkbox" class="fast-symptom" value="–ö–∞—à–µ–ª—å" /> –ö–∞—à–µ–ª—å</label>
            <label><input type="checkbox" class="fast-symptom" value="–ß–∏—Ö–∞–Ω–∏–µ" /> –ß–∏—Ö–∞–Ω–∏–µ</label>
            <label><input type="checkbox" class="fast-symptom" value="–ó—É–¥" /> –ó—É–¥</label>
            <label><input type="checkbox" class="fast-symptom" value="–•—Ä–æ–º–æ—Ç–∞" /> –•—Ä–æ–º–æ—Ç–∞</label>
            <label><input type="checkbox" class="fast-symptom" value="–ü–æ—Ç–µ—Ä—è –≤–µ—Å–∞" /> –ü–æ—Ç–µ—Ä—è –≤–µ—Å–∞</label>
          </div>

          <div class="btn-row">
            <button class="btn btn-ghost" type="button" id="clearFast">–û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn btn-primary" type="button" id="analyzeFastBtn">
              <span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span>
              <span>‚Üí</span>
            </button>
          </div>
        </div>

        <div class="ai-result" id="fastResult">
          <div class="ai-result-header">
            <span class="dot"></span>
            <span class="ai-result-title">–ò–ò‚Äë—Ä–∞–∑–±–æ—Ä —Å–∏–º–ø—Ç–æ–º–æ–≤</span>
          </div>
          <div class="ai-result-body" id="fastResultBody"></div>
        </div>

        <div class="chat-container" id="fastChatMode">
          <div class="chat-messages" id="fastChatMessages"></div>
          <div class="chat-input-row">
            <div class="input-wrapper" style="margin: 0;">
              <span class="leading-icon">üí¨</span>
              <textarea id="fastChatInput" placeholder="–ó–∞–¥–∞–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="sendFollowUpQuestion('fast')" style="padding: 10px 14px; margin: 0;">
              ‚Üë
            </button>
          </div>
        </div>

        <div class="btn-row" id="fastChatControls" style="display: none; margin-top: 12px;">
          <button class="btn btn-ghost" onclick="resetAnalysis('fast')">
            <span>üîÑ –ù–æ–≤—ã–π —á–∞—Ç</span>
          </button>
        </div>
      </section>

      <!-- –ü–û –§–û–¢–û -->
      <section class="card" id="tab-photo" style="display:none;">
        <div class="card-header">
          <div>
            <div class="card-title">üì∏ –ê–Ω–∞–ª–∏–∑ –ø–æ —Ñ–æ—Ç–æ</div>
            <div class="card-subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –ø—Ä–æ–±–ª–µ–º–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏</div>
          </div>
          <div class="chip">
            <span>üëÅÔ∏è</span>
            <span>–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ</span>
          </div>
        </div>

        <div id="photoFormMode">
          <div class="file-upload-zone" id="photoUploadZone">
            <div class="file-upload-text">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –ø–∏—Ç–æ–º—Ü–∞</div>
            <div class="file-upload-hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPG, PNG (–º–∞–∫—Å. 10 –ú–ë)</div>
            <input type="file" id="photoInput" accept="image/*" />
          </div>

          <div id="photoPreview" style="display:none; margin-top:10px;">
            <img id="previewImg" style="width:100%; border-radius:14px; max-height:200px; object-fit:cover;" />
          </div>

          <div class="field">
            <div class="field-label">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</div>
            <div class="input-wrapper">
              <span class="leading-icon">üìù</span>
              <input id="photoDescInput" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..." />
            </div>
          </div>

          <div class="btn-row">
            <button class="btn btn-ghost" type="button" id="clearPhoto">–û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn btn-primary" type="button" id="analyzePhotoBtn">
              <span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span>
              <span>‚Üí</span>
            </button>
          </div>
        </div>

        <div class="ai-result" id="photoResult">
          <div class="ai-result-header">
            <span class="dot"></span>
            <span class="ai-result-title">–ò–ò‚Äë—Ä–∞–∑–±–æ—Ä —Ñ–æ—Ç–æ</span>
          </div>
          <div class="ai-result-body" id="photoResultBody"></div>
        </div>

        <div class="chat-container" id="photoChatMode">
          <div class="chat-messages" id="photoChatMessages"></div>
          <div class="chat-input-row">
            <div class="input-wrapper" style="margin: 0;">
              <span class="leading-icon">üí¨</span>
              <textarea id="photoChatInput" placeholder="–ó–∞–¥–∞–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="sendFollowUpQuestion('photo')" style="padding: 10px 14px; margin: 0;">
              ‚Üë
            </button>
          </div>
        </div>

        <div class="btn-row" id="photoChatControls" style="display: none; margin-top: 12px;">
          <button class="btn btn-ghost" onclick="resetAnalysis('photo')">
            <span>üîÑ –ù–æ–≤—ã–π —á–∞—Ç</span>
          </button>
        </div>
      </section>

      <!-- –ò–ù–°–¢–†–£–ö–¶–ò–Ø -->
      <section class="card" id="sidebar-card">
        <div class="card-header">
          <div>
            <div class="card-title">üéì –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</div>
            <div class="card-subtitle" style="margin-top:2px;">–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</div>
          </div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 12px; font-size: 12px; color: var(--text-muted); line-height: 1.6;">
          <div>
            <strong style="color: var(--text);">1Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –ø–∏—Ç–æ–º—Ü–∞</strong>
            <p style="margin: 4px 0 0 0;">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "‚ûï –î–æ–±–∞–≤–∏—Ç—å" –≤ —Å–∞–π–¥–±–∞—Ä–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</p>
          </div>
          <div>
            <strong style="color: var(--text);">2Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –∞–Ω–∞–ª–∏–∑–∞</strong>
            <p style="margin: 4px 0 0 0;">üìù –ü–æ —Å–∏–º–ø—Ç–æ–º–∞–º, ‚ö° –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–ª–∏ üì∏ –ü–æ —Ñ–æ—Ç–æ</p>
          </div>
          <div>
            <strong style="color: var(--text);">3Ô∏è‚É£ –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É</strong>
            <p style="margin: 4px 0 0 0;">–ü–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–∏–º–ø—Ç–æ–º–∞—Ö –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ</p>
          </div>
          <div>
            <strong style="color: var(--text);">4Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ –∞–Ω–∞–ª–∏–∑</strong>
            <p style="margin: 4px 0 0 0;">–ò–ò –¥–∞—Å—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>
          </div>
          <div>
            <strong style="color: var(--text);">5Ô∏è‚É£ –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã</strong>
            <p style="margin: 4px 0 0 0;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∞—Ç –¥–ª—è –¥–æ–ø. –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º</p>
          </div>
          <div>
            <strong style="color: var(--text);">6Ô∏è‚É£ –ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å</strong>
            <p style="margin: 4px 0 0 0;">–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É</p>
          </div>
        </div>
      </section>
    </div>
  </main>
</div>

<script>
  // =============== RESPONSIVE CONTROLS ===============
  const hamburger = document.getElementById('hamburger');
  const sidebar = document.getElementById('sidebar');

  hamburger.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    sidebar.classList.toggle('active');
  });

  function closeSidebar() {
    hamburger.classList.remove('active');
    sidebar.classList.remove('active');
  }

  // Close sidebar when clicking outside
  document.addEventListener('click', (e) => {
    if (window.innerWidth < 1000) {
      if (!sidebar.contains(e.target) && !hamburger.contains(e.target)) {
        closeSidebar();
      }
    }
  });

  // =============== STATE ===============
  const state = {
    currentPet: { name: '–í–∞—à –ø–∏—Ç–æ–º–µ—Ü', type: '–°–æ–±–∞–∫–∞', gender: '–°–∞–º–µ—Ü', emoji: 'üêï', breed: '', age: '', weight: '' },
    pets: [],
    history: [],
    apiKey: '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',
    chatHistory: {
      symptoms: [],
      fast: [],
      photo: []
    },
    initialPrompts: {
      symptoms: null,
      fast: null,
      photo: null
    }
  };

  // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å localStorage
  function loadData() {
    const saved = localStorage.getItem('petHealthAI');
    if (saved) {
      const data = JSON.parse(saved);
      state.pets = data.pets || [];
      state.history = data.history || [];
      if (state.pets.length > 0) {
        state.currentPet = state.pets[0];
        updateSidebarPet();
        updatePetsList();
      }
    }
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
  function saveData() {
    localStorage.setItem('petHealthAI', JSON.stringify({
      pets: state.pets,
      history: state.history
    }));
  }

  // =============== PET MANAGEMENT ===============
  function openPetModal() {
    document.getElementById('registerPetModal').classList.add('active');
  }

  function savePet() {
    const name = document.getElementById('petNameInput').value.trim();
    const type = document.getElementById('petTypeSelect').value;
    const gender = document.getElementById('petGenderSelect').value;
    const breed = document.getElementById('petBreedInput').value.trim();
    const age = document.getElementById('petAgeInput').value;
    const weight = document.getElementById('petWeightInput').value;

    if (!name || !type || !gender) {
      alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
      return;
    }

    const emoji = type.split(' ')[0];
    const petType = type.split(' ').slice(1).join(' ');
    const petGender = gender.split(' ').slice(1).join(' ');

    const pet = { name, type: petType, gender: petGender, emoji, breed, age, weight };
    state.pets.push(pet);
    state.currentPet = pet;

    document.getElementById('registerPetModal').classList.remove('active');
    document.getElementById('petNameInput').value = '';
    document.getElementById('petTypeSelect').value = '';
    document.getElementById('petGenderSelect').value = '';
    document.getElementById('petBreedInput').value = '';
    document.getElementById('petAgeInput').value = '';
    document.getElementById('petWeightInput').value = '';

    updateSidebarPet();
    updatePetsList();
    saveData();
  }

  function selectPet(index) {
    state.currentPet = state.pets[index];
    updateSidebarPet();
    updatePetsList();
    closeSidebar();
  }

  function togglePetsList() {
    const list = document.getElementById('petsList');
    list.style.display = list.style.display === 'none' ? 'block' : 'none';
  }

  function updatePetsList() {
    const container = document.getElementById('petsListContainer');
    if (state.pets.length === 0) {
      container.innerHTML = '<div style="font-size:11px; color:var(--text-muted);">–ü–∏—Ç–æ–º—Ü–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>';
      return;
    }

    container.innerHTML = state.pets.map((pet, idx) => `
      <div class="pet-item ${pet === state.currentPet ? 'active' : ''}" onclick="selectPet(${idx})">
        <span>${pet.emoji}</span>
        <div style="flex: 1; text-align: left;">
          <div style="font-size: 12px; font-weight: 600;">${pet.name}</div>
          <div style="font-size: 11px; color: var(--text-muted);">${pet.type} ‚Ä¢ ${pet.gender}</div>
        </div>
      </div>
    `).join('');
  }

  function updateSidebarPet() {
    document.getElementById('sidebarPetName').textContent = state.currentPet.name;
    document.getElementById('sidebarPetMeta').textContent = `${state.currentPet.type} ‚Ä¢ ${state.currentPet.gender}`;
    document.getElementById('sidebarAvatar').textContent = state.currentPet.emoji;
  }

  // =============== ELEMENTS ===============
  const symptomsInput = document.getElementById('symptomsInput');
  const extraInfoInput = document.getElementById('extraInfoInput');
  const analyzeSymptomsBtn = document.getElementById('analyzeSymptomsBtn');
  const clearSymptoms = document.getElementById('clearSymptoms');

  const fastCheckboxes = document.querySelectorAll('.fast-symptom');
  const analyzeFastBtn = document.getElementById('analyzeFastBtn');
  const clearFast = document.getElementById('clearFast');

  const photoInput = document.getElementById('photoInput');
  const photoUploadZone = document.getElementById('photoUploadZone');
  const photoPreview = document.getElementById('photoPreview');
  const previewImg = document.getElementById('previewImg');
  const photoDescInput = document.getElementById('photoDescInput');
  const analyzePhotoBtn = document.getElementById('analyzePhotoBtn');
  const clearPhoto = document.getElementById('clearPhoto');

  const progressBar = document.getElementById('requestProgress');
  const tabBtns = document.querySelectorAll('.tab-btn');
  const modeTabs = document.querySelectorAll('[id^="tab-"]');

  // =============== TAB SWITCHING ===============
  tabBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      tabBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const tabName = btn.dataset.tab;
      modeTabs.forEach(tab => {
        tab.style.display = tab.id === `tab-${tabName}` ? 'flex' : 'none';
      });
    });
  });

  // =============== OPENROUTER API ===============
  async function callOpenRouterAPI(messages) {
    try {
      const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${state.apiKey}`,
          'Content-Type': 'application/json',
          'HTTP-Referer': window.location.href,
          'X-Title': 'Pet Health AI'
        },
        body: JSON.stringify({
          model: 'tngtech/deepseek-r1t2-chimera:free',
          messages: messages,
          max_tokens: 1500,
          temperature: 0.7
        })
      });

      if (!response.ok) {
        throw new Error(`API Error: ${response.status}`);
      }

      const data = await response.json();
      const content = data.choices[0].message.content;
      return content;
    } catch (error) {
      console.error('OpenRouter API Error:', error);
      return null;
    }
  }

  // =============== FORMAT AI RESPONSE ===============
  function formatAIResponse(text) {
    return text
      .replace(/^###\s+(.*?)$/gm, '<h4>$1</h4>')
      .replace(/^##\s+(.*?)$/gm, '<h4>$1</h4>')
      .replace(/^#\s+(.*?)$/gm, '<h4>$1</h4>')
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/\*(.*?)\*/g, '<em>$1</em>')
      .replace(/^-\s+(.*?)$/gm, '<li>$1</li>')
      .replace(/(<li>.*?<\/li>)/s, '<ul>$1</ul>')
      .replace(/\n/g, '<br>');
  }

  // =============== PROGRESS ===============
  function showProgress() {
    progressBar.classList.add('active');
  }

  function hideProgress() {
    progressBar.classList.remove('active');
  }

  // =============== ANALYZE SYMPTOMS ===============
  async function analyzeSymptoms() {
    const symptoms = symptomsInput.value.trim();
    const extraInfo = extraInfoInput.value.trim();

    if (!symptoms) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã');
      return;
    }

    showProgress();
    analyzeSymptomsBtn.disabled = true;

    const petInfo = `–ü–∏—Ç–æ–º–µ—Ü: ${state.currentPet.name} (${state.currentPet.emoji} ${state.currentPet.type}, ${state.currentPet.gender})${state.currentPet.age ? ', –≤–æ–∑—Ä–∞—Å—Ç: ' + state.currentPet.age + ' –ª–µ—Ç' : ''}${state.currentPet.weight ? ', –≤–µ—Å: ' + state.currentPet.weight + ' –∫–≥' : ''}`;

    const userMessage = `${petInfo}

–°–∏–º–ø—Ç–æ–º—ã: ${symptoms}

${extraInfo ? `–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: ${extraInfo}` : ''}`;

    const messages = [
      {
        role: 'system',
        content: `–¢—ã –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –ö–†–ê–¢–ö–û –ò –ü–û –ü–û–†–Ø–î–ö–£. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è –ø—É–Ω–∫—Ç–æ–≤
- –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –≤–∞–∂–Ω–æ–≥–æ
- –ú–∞–∫—Å–∏–º—É–º 5-6 –ø—É–Ω–∫—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ä–∞–∑–¥–µ–ª–µ

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–∏–º–ø—Ç–æ–º—ã –ø–∏—Ç–æ–º—Ü–µ–≤ –∏ –¥–∞–≤–∞–π –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. –ì–æ–≤–æ—Ä–∏ —Ç–æ–ª—å–∫–æ –ø–æ-—Ä—É—Å—Å–∫–∏. –ù–µ –∑–∞–º–µ–Ω—è–π –≤–∏–∑–∏—Ç –∫ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:
1. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (2-3 –ø—É–Ω–∫—Ç–∞)
2. –ü–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å (2-3 –¥–µ–π—Å—Ç–≤–∏—è)
3. –ö–æ–≥–¥–∞ –∫ –≤—Ä–∞—á—É (–∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏)
4. –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ (1-2 —Å–æ–≤–µ—Ç–∞)`
      },
      { role: 'user', content: userMessage }
    ];

    const response = await callOpenRouterAPI(messages);
    hideProgress();
    analyzeSymptomsBtn.disabled = false;

    if (response) {
      state.chatHistory.symptoms = messages;
      state.chatHistory.symptoms.push({ role: 'assistant', content: response });
      state.initialPrompts.symptoms = userMessage;
      
      displaySymptomResult(response);
      showChatMode('symptoms');
      addToHistory(symptoms, '—Å–∏–º–ø—Ç–æ–º—ã');
    } else {
      alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.');
    }
  }

  function displaySymptomResult(analysis) {
    document.getElementById('symptomsResultBody').innerHTML = formatAIResponse(analysis);
    document.getElementById('symptomsResult').classList.add('visible');
  }

  function showChatMode(type) {
    document.getElementById(`${type}FormMode`).style.display = 'none';
    document.getElementById(`${type}Result`).style.display = 'none';
    document.getElementById(`${type}ChatMode`).classList.add('active');
    document.getElementById(`${type}ChatControls`).style.display = 'flex';
    
    renderChatMessages(type);
  }

  function renderChatMessages(type) {
    const container = document.getElementById(`${type}ChatMessages`);
    container.innerHTML = state.chatHistory[type]
      .filter(msg => msg.role !== 'system')
      .map(msg => `
        <div class="chat-message ${msg.role}">
          ${msg.role === 'assistant' ? formatAIResponse(msg.content) : msg.content}
        </div>
      `).join('');
    container.scrollTop = container.scrollHeight;
  }

  async function sendFollowUpQuestion(type) {
    const inputElement = document.getElementById(`${type}ChatInput`);
    const question = inputElement.value.trim();

    if (!question) return;

    const messagesContainer = document.getElementById(`${type}ChatMessages`);
    const userMsgDiv = document.createElement('div');
    userMsgDiv.className = 'chat-message user';
    userMsgDiv.textContent = question;
    messagesContainer.appendChild(userMsgDiv);

    const loadingMsgDiv = document.createElement('div');
    loadingMsgDiv.className = 'chat-message loading';
    loadingMsgDiv.textContent = '–ò–ò –ø–µ—á–∞—Ç–∞–µ—Ç';
    messagesContainer.appendChild(loadingMsgDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;

    inputElement.value = '';
    inputElement.disabled = true;

    state.chatHistory[type].push({ role: 'user', content: question });

    const response = await callOpenRouterAPI(state.chatHistory[type]);
    
    inputElement.disabled = false;

    if (response) {
      messagesContainer.removeChild(loadingMsgDiv);
      state.chatHistory[type].push({ role: 'assistant', content: response });
      
      const aiMsgDiv = document.createElement('div');
      aiMsgDiv.className = 'chat-message ai';
      aiMsgDiv.innerHTML = formatAIResponse(response);
      messagesContainer.appendChild(aiMsgDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    } else {
      messagesContainer.removeChild(loadingMsgDiv);
      alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–æ–ø—Ä–æ—Å–∞');
    }
  }

  function resetAnalysis(type) {
    state.chatHistory[type] = [];
    state.initialPrompts[type] = null;

    document.getElementById(`${type}FormMode`).style.display = 'block';
    document.getElementById(`${type}Result`).style.display = 'none';
    document.getElementById(`${type}ChatMode`).classList.remove('active');
    document.getElementById(`${type}ChatControls`).style.display = 'none';
    document.getElementById(`${type}ChatInput`).value = '';
    document.getElementById(`${type}ChatMessages`).innerHTML = '';

    if (type === 'symptoms') {
      symptomsInput.value = '';
      extraInfoInput.value = '';
    } else if (type === 'fast') {
      fastCheckboxes.forEach(cb => cb.checked = false);
    } else if (type === 'photo') {
      photoInput.value = '';
      photoDescInput.value = '';
      photoPreview.style.display = 'none';
    }
  }

  // =============== ANALYZE FAST ===============
  async function analyzeFast() {
    const selected = Array.from(fastCheckboxes)
      .filter(cb => cb.checked)
      .map(cb => cb.value);

    if (selected.length === 0) {
      alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–∏–º–ø—Ç–æ–º');
      return;
    }

    showProgress();
    analyzeFastBtn.disabled = true;

    const userMessage = `–ü–∏—Ç–æ–º–µ—Ü: ${state.currentPet.name} (${state.currentPet.emoji} ${state.currentPet.type}, ${state.currentPet.gender})

–°–∏–º–ø—Ç–æ–º—ã: ${selected.join(', ')}`;

    const messages = [
      {
        role: 'system',
        content: `–¢—ã –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –ö–†–ê–¢–ö–û –ò –ü–û –ü–û–†–Ø–î–ö–£. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
- –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –≤–∞–∂–Ω–æ–≥–æ
–ú–∞–∫—Å–∏–º—É–º 4-5 –ø—É–Ω–∫—Ç–æ–≤. –°—Ç—Ä—É–∫—Ç—É—Ä–∞: 1) –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã, 2) –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–æ–º–∞, 3) –ö–æ–≥–¥–∞ –∫ –≤—Ä–∞—á—É`
      },
      { role: 'user', content: userMessage }
    ];

    const response = await callOpenRouterAPI(messages);
    hideProgress();
    analyzeFastBtn.disabled = false;

    if (response) {
      state.chatHistory.fast = messages;
      state.chatHistory.fast.push({ role: 'assistant', content: response });
      state.initialPrompts.fast = userMessage;

      document.getElementById('fastResultBody').innerHTML = formatAIResponse(response);
      document.getElementById('fastResult').classList.add('visible');
      showChatMode('fast');
      addToHistory(selected.join(', '), '–±—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä');
    }
  }

  // =============== PHOTO ===============
  photoUploadZone.addEventListener('click', () => photoInput.click());

  photoInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (evt) => {
        previewImg.src = evt.target.result;
        photoPreview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }
  });

  async function analyzePhoto() {
    if (!photoInput.files.length) {
      alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ');
      return;
    }

    showProgress();
    analyzePhotoBtn.disabled = true;

    const description = photoDescInput.value.trim();
    const userMessage = `–ü–∏—Ç–æ–º–µ—Ü: ${state.currentPet.name} (${state.currentPet.emoji} ${state.currentPet.type}, ${state.currentPet.gender})

${description ? `–û–ø–∏—Å–∞–Ω–∏–µ: ${description}` : ''}

–ù–∞ —Ñ–æ—Ç–æ –≤–∏–¥–µ–Ω –º–æ–π –ø–∏—Ç–æ–º–µ—Ü. –ü–æ–º–æ–≥–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å.`;

    const messages = [
      {
        role: 'system',
        content: `–¢—ã –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –ö–†–ê–¢–ö–û –ò –ü–û –ü–û–†–Ø–î–ö–£. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–æ–≤
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
- –ñ–∏—Ä–Ω—ã–π –¥–ª—è –≤–∞–∂–Ω–æ–≥–æ
–ú–∞–∫—Å–∏–º—É–º 4-5 –ø—É–Ω–∫—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–¥–µ–ª. –°—Ç—Ä—É–∫—Ç—É—Ä–∞: 1) –ß—Ç–æ –≤–∏–¥–Ω–æ –Ω–∞ —Ñ–æ—Ç–æ, 2) –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã, 3) –ß—Ç–æ –¥–µ–ª–∞—Ç—å, 4) –ö–æ–≥–¥–∞ —Å—Ä–æ—á–Ω–æ`
      },
      { role: 'user', content: userMessage }
    ];

    const response = await callOpenRouterAPI(messages);
    hideProgress();
    analyzePhotoBtn.disabled = false;

    if (response) {
      state.chatHistory.photo = messages;
      state.chatHistory.photo.push({ role: 'assistant', content: response });
      state.initialPrompts.photo = userMessage;

      document.getElementById('photoResultBody').innerHTML = formatAIResponse(response);
      document.getElementById('photoResult').classList.add('visible');
      showChatMode('photo');
      addToHistory('–§–æ—Ç–æ –∞–Ω–∞–ª–∏–∑', '—Ñ–æ—Ç–æ');
    }
  }

  // =============== HISTORY ===============
  function addToHistory(text, type) {
    const time = new Date().toLocaleTimeString('ru-RU', {
      hour: '2-digit',
      minute: '2-digit'
    });

    const item = {
      text: text.substring(0, 50),
      type: type,
      time: time,
      full: text,
      petName: state.currentPet.name
    };

    state.history.unshift(item);
    if (state.history.length > 20) state.history.pop();

    saveData();
  }

  // =============== EVENT LISTENERS ===============
  analyzeSymptomsBtn.addEventListener('click', analyzeSymptoms);
  clearSymptoms.addEventListener('click', () => {
    symptomsInput.value = '';
    extraInfoInput.value = '';
    document.getElementById('symptomsResult').classList.remove('visible');
  });

  analyzeFastBtn.addEventListener('click', analyzeFast);
  clearFast.addEventListener('click', () => {
    fastCheckboxes.forEach(cb => cb.checked = false);
    document.getElementById('fastResult').classList.remove('visible');
  });

  analyzePhotoBtn.addEventListener('click', analyzePhoto);
  clearPhoto.addEventListener('click', () => {
    photoInput.value = '';
    photoDescInput.value = '';
    photoPreview.style.display = 'none';
    document.getElementById('photoResult').classList.remove('visible');
  });

  // INIT
  loadData();
  updateSidebarPet();
</script>
</body>
</html>
